parameters:
  - name: environment
    type: string
  - name: workingDirectory
    type: string

steps:
  - script: |
      terraform workspace select ${{ parameters.environment }} || terraform workspace new ${{ parameters.environment }}
      terraform plan -var-file="${{ parameters.environment }}.tfvars"
    workingDirectory: ${{ parameters.workingDirectory }}
    displayName: 'Terraform Plan'
